<!DOCTYPE html>
<html>
<body>
<input type="button" onclick="alert('hello')" value="Hello" text="world" />
<script>
  // Add widget
  (function() {
    var rcs = document.createElement("script");
    var url1 = "https://ringcentral.github.io/ringcentral-embeddable-voice/adapter.js";
    var url2 = url1;
    url2 = url2 + '?stylesUri=https://embbnux.github.io/ringcentral-web-widget-styles/GameofThrones/styles.css';
    //var url2 = "https://ringcentral.github.io/ringcentral-embeddable-voice/adapter.js?appKey=0kntE6UGRs2mpUY8r-Uh0w&appServer=aAtwEuusT9akGqyDU7oMVAi9CkqRTaSsaTODvuE3RGaw";
    //&redirectUri=https://platform.devtest.ringcentral.com
    rcs.src = url2;
    var rcs0 = document.getElementsByTagName("script")[0];
    rcs0.parentNode.insertBefore(rcs, rcs0);
  })();
</script>
<script>
  // Register your service
  function registerService() {
    document.querySelector("#rc-widget-adapter-frame").contentWindow.postMessage({
      type: 'rc-adapter-register-third-party-service',
      service: {
        name: 'Game of Thrones',
        conferenceInvitePath: '/conference/invite',
        conferenceInviteTitle: 'Invite with Office 365 Calendar',
        contactsPath: '/contacts',
        contactSearchPath: '/contacts/search',
        contactMatchPath: '/contacts/match',
        activitiesPath: '/activities',
        activityPath: '/activity'
      }
    }, '*');
  }

  // Function to response message to widget
  function responseMessage(request, response) {
    console.log(request);
    document.querySelector("#rc-widget-adapter-frame").contentWindow.postMessage({
      type: 'rc-post-message-response',
      responseId: request.requestId,
      response,
    }, '*');
  }

  function inviteConference(request) {
    var calendarUrl = buildO365CalendarUrl({
      'subject':'New Conference',
      'body': request.body.conference.inviteText});
    window.open(calendarUrl);

    responseMessage(request, { data: 'ok' });
  }

  function buildO365CalendarUrl(params={}) {
    var calendarUrl = 'https://outlook.office.com/owa/?path=/calendar/action/compose';
    var encoded = [];
    if ('subject' in params) {
      encoded.push('subject=' + encodeURIComponent(params['subject']));
    }
    if ('body' in params) {
      encoded.push('body=' + encodeURIComponent(params['body']));
    }
    if (encoded.length > 0) {
      calendarUrl = calendarUrl + '&' + encoded.join('&');
    }
    return calendarUrl;
  }

  function getContacts(request) {
    responseMessage(request, {
      data: [{"id":"+14235550143","name":"Eddard \"Ned\" Stark","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14235550143","phoneType":"directPhone"}]},{"id":"+19405550179","name":"Robert Baratheon","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19405550179","phoneType":"directPhone"}]},{"id":"+18635550196","name":"Jaime Lannister","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+18635550196","phoneType":"directPhone"}]},{"id":"+17345550115","name":"Catelyn Stark","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17345550115","phoneType":"directPhone"}]},{"id":"+17065550189","name":"Cersei Lannister","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17065550189","phoneType":"directPhone"}]},{"id":"+17695550194","name":"Daenerys Targaryen","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17695550194","phoneType":"directPhone"}]},{"id":"+13125550173","name":"Jorah Mormont","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13125550173","phoneType":"directPhone"}]},{"id":"+19165550105","name":"Petyr \"Littlefinger\" Baelish","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19165550105","phoneType":"directPhone"}]},{"id":"+16675550145","name":"Viserys Targaryen","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+16675550145","phoneType":"directPhone"}]},{"id":"+15165550106","name":"Jon Snow","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15165550106","phoneType":"directPhone"}]},{"id":"+18105550112","name":"Sansa Stark","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+18105550112","phoneType":"directPhone"}]},{"id":"+13605550144","name":"Arya Stark","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13605550144","phoneType":"directPhone"}]},{"id":"+19855550190","name":"Robb Stark","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19855550190","phoneType":"directPhone"}]},{"id":"+19595550117","name":"Theon Greyjoy","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19595550117","phoneType":"directPhone"}]},{"id":"+18545550126","name":"Bran Stark","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+18545550126","phoneType":"directPhone"}]},{"id":"+18325550147","name":"Joffrey Baratheon","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+18325550147","phoneType":"directPhone"}]},{"id":"+15025550118","name":"Sandor \"The Hound\" Clegane","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15025550118","phoneType":"directPhone"}]},{"id":"+13365550168","name":"Tyrion Lannister","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13365550168","phoneType":"directPhone"}]},{"id":"+12285550114","name":"Khal Drogo","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+12285550114","phoneType":"directPhone"}]},{"id":"+18175550198","name":"Tywin Lannister","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+18175550198","phoneType":"directPhone"}]},{"id":"+15405550105","name":"Davos Seaworth","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15405550105","phoneType":"directPhone"}]},{"id":"+17815550160","name":"Samwell Tarly","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17815550160","phoneType":"directPhone"}]},{"id":"+17255550134","name":"Margaery Tyrell","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17255550134","phoneType":"directPhone"}]},{"id":"+18585550177","name":"Stannis Baratheon","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+18585550177","phoneType":"directPhone"}]},{"id":"+15615550104","name":"Melisandre","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15615550104","phoneType":"directPhone"}]},{"id":"+17435550184","name":"Jeor Mormont","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17435550184","phoneType":"directPhone"}]},{"id":"+13055550178","name":"Bronn","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13055550178","phoneType":"directPhone"}]},{"id":"+13855550112","name":"Varys","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13855550112","phoneType":"directPhone"}]},{"id":"+16305550186","name":"Shae","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+16305550186","phoneType":"directPhone"}]},{"id":"+19315550152","name":"Ygritte","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19315550152","phoneType":"directPhone"}]},{"id":"+17345550150","name":"Talisa Maegyr","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17345550150","phoneType":"directPhone"}]},{"id":"+15305550167","name":"Gendry","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15305550167","phoneType":"directPhone"}]},{"id":"+13215550185","name":"Tormund Giantsbane","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13215550185","phoneType":"directPhone"}]},{"id":"+12165550190","name":"Gilly","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+12165550190","phoneType":"directPhone"}]},{"id":"+16175550112","name":"Brienne of Tarth","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+16175550112","phoneType":"directPhone"}]},{"id":"+13515550181","name":"Ramsay Bolton","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13515550181","phoneType":"directPhone"}]},{"id":"+12535550198","name":"Ellaria Sand","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+12535550198","phoneType":"directPhone"}]},{"id":"+13205550184","name":"Daario Naharis","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13205550184","phoneType":"directPhone"}]},{"id":"+15715550190","name":"Missandei","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15715550190","phoneType":"directPhone"}]},{"id":"+14045550113","name":"Jaqen H'ghar","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14045550113","phoneType":"directPhone"}]},{"id":"+19565550186","name":"Tommen Baratheon","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19565550186","phoneType":"directPhone"}]},{"id":"+14435550107","name":"Roose Bolton","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14435550107","phoneType":"directPhone"}]},{"id":"+13855550110","name":"The High Sparrow","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13855550110","phoneType":"directPhone"}]},{"id":"+17245550135","name":"Grand Maester Pycelle","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17245550135","phoneType":"directPhone"}]},{"id":"+12255550110","name":"Meryn Trant","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+12255550110","phoneType":"directPhone"}]},{"id":"+17065550116","name":"Hodor","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17065550116","phoneType":"directPhone"}]},{"id":"+17205550167","name":"Grenn","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17205550167","phoneType":"directPhone"}]},{"id":"+19855550124","name":"Osha","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19855550124","phoneType":"directPhone"}]},{"id":"+14125550109","name":"Rickon Stark","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14125550109","phoneType":"directPhone"}]},{"id":"+17155550162","name":"Ros","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17155550162","phoneType":"directPhone"}]},{"id":"+14085550123","name":"Gregor Clegane","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14085550123","phoneType":"directPhone"}]},{"id":"+13035550141","name":"Janos Slynt","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13035550141","phoneType":"directPhone"}]},{"id":"+15395550189","name":"Lancel Lannister","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15395550189","phoneType":"directPhone"}]},{"id":"+18325550129","name":"Myrcella Baratheon","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+18325550129","phoneType":"directPhone"}]},{"id":"+15635550193","name":"Rodrik Cassel","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15635550193","phoneType":"directPhone"}]},{"id":"+19785550125","name":"Maester Luwin","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19785550125","phoneType":"directPhone"}]},{"id":"+16165550193","name":"Irri","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+16165550193","phoneType":"directPhone"}]},{"id":"+17275550173","name":"Doreah","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17275550173","phoneType":"directPhone"}]},{"id":"+17015550175","name":"Kevan Lannister","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17015550175","phoneType":"directPhone"}]},{"id":"+17175550104","name":"Barristan Selmy","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17175550104","phoneType":"directPhone"}]},{"id":"+13375550115","name":"Rast","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+13375550115","phoneType":"directPhone"}]},{"id":"+16085550198","name":"Maester Aemon","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+16085550198","phoneType":"directPhone"}]},{"id":"+19155550177","name":"Pypar","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19155550177","phoneType":"directPhone"}]},{"id":"+14105550118","name":"Alliser Thorne","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14105550118","phoneType":"directPhone"}]},{"id":"+15055550136","name":"Othell Yarwyck","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15055550136","phoneType":"directPhone"}]},{"id":"+14075550115","name":"Loras Tyrell","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14075550115","phoneType":"directPhone"}]},{"id":"+15125550176","name":"Hot Pie","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15125550176","phoneType":"directPhone"}]},{"id":"+19315550178","name":"Beric Dondarrion","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19315550178","phoneType":"directPhone"}]},{"id":"+18175550110","name":"Podrick Payne","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+18175550110","phoneType":"directPhone"}]},{"id":"+17205550116","name":"Eddison Tollett","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17205550116","phoneType":"directPhone"}]},{"id":"+14075550165","name":"Yara Greyjoy","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14075550165","phoneType":"directPhone"}]},{"id":"+19785550131","name":"Selyse Florent","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+19785550131","phoneType":"directPhone"}]},{"id":"+15635550105","name":"Little Sam","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15635550105","phoneType":"directPhone"}]},{"id":"+18435550141","name":"Grey Worm","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+18435550141","phoneType":"directPhone"}]},{"id":"+15855550106","name":"Qyburn","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15855550106","phoneType":"directPhone"}]},{"id":"+12705550171","name":"Olenna Tyrell","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+12705550171","phoneType":"directPhone"}]},{"id":"+16065550170","name":"Shireen Baratheon","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+16065550170","phoneType":"directPhone"}]},{"id":"+14695550146","name":"Meera Reed","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14695550146","phoneType":"directPhone"}]},{"id":"+17125550144","name":"Jojen Reed","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17125550144","phoneType":"directPhone"}]},{"id":"+15705550142","name":"Thoros of Myr","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15705550142","phoneType":"directPhone"}]},{"id":"+17725550196","name":"Olly","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17725550196","phoneType":"directPhone"}]},{"id":"+14255550163","name":"Mace Tyrell","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+14255550163","phoneType":"directPhone"}]},{"id":"+17705550125","name":"The Waif","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+17705550125","phoneType":"directPhone"}]},{"id":"+15045550150","name":"Bowen Marsh","type":"Game of Thrones","phoneNumbers":[{"phoneNumber":"+15045550150","phoneType":"directPhone"}]}]
    });
  }

  function searchContacts(request) {
    responseMessage(request, {
      data: [{
        id: '123456',
        name: 'TestService Name',
        type: 'TestService Name',
        phoneNumbers: [{
          phoneNumber: '+16579991394',
          phoneType: 'directPhone',
        }]
      }]
    });
  }

  function matchContacts(request) {
    responseMessage(request, {
      data: {
        '+12165325078': [
          {
            entityType: 'TestService',
            name: 'TestService 1',
            phoneNumbers: [{
              phoneNumber: '+12165325078',
              phoneType: 'directPhone',
            }]
          }
        ]
      }
    });
  }

  function getActivities(request) {
    responseMessage(request, {
      data: [{
        id: '123',
        subject: 'Title',
        time: 1528854702472
      }]
    });
  }

  function getActivity(request) {
    responseMessage(request, { data: 'ok' });
  }

  // Add message event to response to the widget
  window.addEventListener('message', function (e) {
    var data = e.data;
    if (data && data.type === 'rc-post-message-request') {
      if (data.path === '/contacts') {
        getContacts(data);
      }
      if (data.path === '/activities') {
        getActivities(data)
      }
      if (data.path === '/activity') {
        getActivity(data);
      }
      if (data.path === '/contacts/search') {
        searchContacts(data);
      }
      if (data.path === '/contacts/match') {
        matchContacts(data);
      }
      if (data.path === '/conference/invite') {
        inviteConference(data);
      }
    }
  });

  // To register the widget when it is ready.
  var registered = false;
  window.addEventListener('message', function (e) {
    const data = e.data;
    if (data && data.type === 'rc-adapter-pushAdapterState' && registered === false) {
      registered = true;
      registerService();
    }
  })
</script>
</body>
</html>